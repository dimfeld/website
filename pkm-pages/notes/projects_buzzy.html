---
title: "Buzzy"
tags: Projects
date: 2023-09-07
updated: 2023-11-28
---


  <ul class="list-bullet">
    <li>Experimental AI bot to talk with my kids and answer questions.</li>
    <li><a href="https://github.com/dimfeld/buzzy">https://github.com/dimfeld/buzzy</a></li>
    <li><h2>Task List</h2>
      <ul class="list-bullet">
        <li><h3>Up Next</h3>
          <ul class="list-bullet">
            <li id="651362e9-deb6-439d-9b3c-c85b3356517b"><input type="checkbox" readonly="true"  /> Basic intent detection</li>
            <li id="651362e9-2c46-420e-ba11-b311988e87ca"><input type="checkbox" readonly="true"  /> Run web searches and generate an answer from the results.</li>
          </ul>        </li>
        <li><h3>Soon</h3>
          <ul class="list-bullet">
            <li><input type="checkbox" readonly="true"  /> read system message from a file</li>
            <li><input type="checkbox" readonly="true"  /> record llm pipeline actions for later analysis</li>
          </ul>        </li>
        <li><h3>Later</h3>
          <ul class="list-bullet">
            <li><input type="checkbox" readonly="true"  /> Check out <a href="https://github.com/FL33TW00D/whisper-turbo">whisper-turbo</a> for in-browser voice recognition</li>
            <li><input type="checkbox" readonly="true"  /> optional configuration to use better models that require GPU</li>
          </ul>        </li>
        <li><h3>Done</h3>
          <ul class="list-bullet">
            <li><input type="checkbox" readonly="true" checked /> set up basic ChatGPT workflow</li>
            <li><input type="checkbox" readonly="true" checked /> Voice recognition</li>
            <li><input type="checkbox" readonly="true" checked /> Basic TTS</li>
            <li><input type="checkbox" readonly="true" checked /> Websocket-based communication</li>
            <li><input type="checkbox" readonly="true" checked /> Stream results back to client</li>
          </ul>        </li>
      </ul>    </li>
    <li><h2>System Prompt Example</h2>
      <ul class="list-bullet">
        <li>You are Buzzy, an AI bot that answers questions for children. Your answers should be appropriate for a smart six year old boy, but also don&#39;t dumb your answers down too much.</li>
      </ul>    </li>
    <li><h2>Ideas</h2>
      <ul class="list-bullet">
        <li>Do I want to do a RAG-based conversation learning/memory?</li>
        <li><input type="checkbox" readonly="true"  /> Decide whether to send back previous chat messages based on how much time has passed.</li>
        <li>Voice recognition to ask questions
          <ul class="list-bullet">
            <li><input type="checkbox" readonly="true" checked /> Choice:
              <ul class="list-bullet">
                <li>Decision: <a class="block-ref" href="/notes/projects_buzzy#651347dc-edce-43bf-8535-54b5c3767a55"><a href="https://huggingface.co/nvidia/stt_en_fastconformer_transducer_large">nvidia/stt_en_fastconformer_transducer_large</a></a></li>
                <li>Options:
                  <ul class="list-bullet">
                    <li>Run <a href="https://whisper.ggerganov.com/">Whisper in browser</a>?</li>
                    <li>Whisper on server?
                      <ul class="list-bullet">
                        <li>Too slow when running on CPU</li>
                      </ul>                    </li>
                    <li id="651347dc-edce-43bf-8535-54b5c3767a55"><a href="https://huggingface.co/nvidia/stt_en_fastconformer_transducer_large">nvidia/stt_en_fastconformer_transducer_large</a>
                      <ul class="list-bullet">
                        <li>runs fast (~500ms for short passages) and works well</li>
                      </ul>                    </li>
                  </ul>                </li>
              </ul>            </li>
            <li>Needs to run ok on just CPU</li>
            <li>Seems to work best to just send the audio in one big chunk to the server.</li>
            <li><a href="https://huggingface.co/spaces/hf-audio/open_asr_leaderboard">Huggingface Voice Recognition Leaderboard</a></li>
          </ul>        </li>
        <li>TTS to say responses
          <ul class="list-bullet">
            <li>How easy is it to use one of the new models for this?</li>
            <li><input type="checkbox" readonly="true" checked /> Choice:
              <ul class="list-bullet">
                <li>Decision: <a class="block-ref" href="/notes/projects_buzzy#651346cb-b67c-4640-81b7-79dd3998fcb5"><a href="https://github.com/MycroftAI/mimic3">Mimic 3</a></a></li>
                <li>Options:
                  <ul class="list-bullet">
                    <li>Bark seems promising
                      <ul class="list-bullet">
                        <li><a href="https://github.com/suno-ai/bark">https://github.com/suno-ai/bark</a></li>
                        <li><a href="https://github.com/serp-ai/bark-with-voice-clone">https://github.com/serp-ai/bark-with-voice-clone</a></li>
                        <li><a href="https://github.com/gitmylo/bark-voice-cloning-HuBERT-quantizer">https://github.com/gitmylo/bark-voice-cloning-HuBERT-quantizer</a></li>
                        <li>Very slow on CPU, RTF of 6-8</li>
                      </ul>                    </li>
                    <li>XTTS
                      <ul class="list-bullet">
                        <li><a href="https://github.com/coqui-ai/TTS/blob/dev/docs/source/models/xtts.md">https://github.com/coqui-ai/TTS/blob/dev/docs/source/models/xtts.md</a></li>
                        <li>Sounds the best, but has RTF of 4-5 on CPU</li>
                      </ul>                    </li>
                    <li id="651346cb-b67c-4640-81b7-79dd3998fcb5"><a href="https://github.com/MycroftAI/mimic3">Mimic 3</a>
                      <ul class="list-bullet">
                        <li>This turns out to be the only solution that both sounds good and runs in realtime on CPU</li>
                        <li>Running with lengthScale 1.2 slows it down a bit and seems to give best results</li>
                      </ul>                    </li>
                  </ul>                </li>
              </ul>            </li>
          </ul>        </li>
        <li>Some kind of 3D avatar that&#39;s like a dinosaur or robot or something?</li>
        <li>Scrensaver mode that does a photo carousel</li>
      </ul>    </li>
    <li><h2>Intent Detection</h2>
      <ul class="list-bullet">
        <li><a href="https://huggingface.co/MoritzLaurer/DeBERTa-v3-base-mnli-fever-anli">DeBERTa-v3-base-mnli-fever-anli </a> seems to work well for this at first try. Haven&#39;t really exercised it significantly yet though. The creator of that model now also has <a href="https://huggingface.co/MoritzLaurer/deberta-v3-large-zeroshot-v1">deberta-v3-large-zeroshot-v1</a>.</li>
        <li>Tasks
          <ul class="list-bullet">
            <li>Figure out if something is a question that can be answered by searching the web and/or wikipedia</li>
            <li>How many days until...</li>
            <li>Show me pictures of...</li>
          </ul>        </li>
        <li>When doing web search and intent , also need to detect if a query builds on the previous queries or not.
          <ul class="list-bullet">
            <li>&quot;No, the blue one&quot; has no context but the context is probably in the previous message.</li>
            <li>Small models don&#39;t seem to do great on this but gpt-3.5-turbo-instruct does well.
              <ul class="list-bullet">
                <li><pre><code><span class="sy-text sy-plain">Assistant: {assistant&#39;s last message}

User: {user&#39;s question}

Does the user&#39;s question ask for clarification on the assistant&#39;s statement? Only answer yes or no.
</span></code></pre></li>
              </ul>            </li>
            <li>For this we can probably just pair up the last assistant message with the latest query, since they tend to include all the necessary info again in every message. Then use GPT to create a proper search for it.</li>
            <li>Do we even need to do the detection? Will it work to just ask GPT to make a search for the query?
              <ul class="list-bullet">
                <li>Takes some tweaking of the prompt but this seems to work well.</li>
                <li><pre><code><span class="sy-text sy-plain">This is an excerpt of a chat with an assistant and a user:

Assistant: {assistant&#39;s last message}

User: {user&#39;s question}

What would be a good web search to answer the user&#39;s question? If the question is asking for clarification on the assistant&#39;s statement, then the web search should account for that. If it is a new line of questioning, then ignore the assistant&#39;s statement. Respond only with the web search and nothing else.

Web search:
</span></code></pre></li>
              </ul>            </li>
          </ul>        </li>
      </ul>    </li>
    <li><h2>Web Search</h2>
      <ul class="list-bullet">
        <li>Use Brave Search API to do web searches to answer questions
          <ul class="list-bullet">
            <li>Should searches be an intent, or should we run searches for anything that doesn&#39;t return another intent?</li>
            <li>Maybe also wikipedia/wikidata?</li>
          </ul>        </li>
      </ul>    </li>
  </ul>

