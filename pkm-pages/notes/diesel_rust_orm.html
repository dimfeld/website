---
title: "Diesel Rust ORM"
tags: Rust
date: 2022-07-04
updated: 2022-07-11
---


  <ul class="list-bullet">
    <li><span><span class="font-medium text-gray-800">Website:</span> <span><a href="https://diesel.rs/">https://diesel.rs/</a></span></span></li>
    <li>Useful other crates
      <ul class="list-bullet">
        <li><a href="https://docs.rs/diesel-derive-enum/latest/diesel_derive_enum/">`diesel-derive-enum`</a> helps with translating between Rust enums and database enum types.</li>
        <li>Although Diesel doesn&#39;t support async natively, there are many packages that enable that support with minimal fuss. I&#39;ve been using <a href="https://docs.rs/deadpool-diesel/latest/deadpool_diesel/">`deadpool-diesel`</a>.</li>
      </ul>    </li>
    <li>Selecting into other structures
      <ul class="list-bullet">
        <li>When creating a reusable structure to select into that isn&#39;t the normal one, you can derive <code>Selectable</code> and then use <code>type::as_select()</code> to return the list of columns for a select column. Note that this structure must also implement <code>Queryable</code>.</li>
        <li>This is useful, for example, for structures that include the columns of a database table that the user should be able to see, while omitting internal data.</li>
        <li><pre><code><span class="sy-source sy-rust"><span class="sy-keyword sy-other sy-rust">use</span> <span class="sy-keyword sy-other sy-rust">crate</span><span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">schema<span class="sy-punctuation sy-accessor sy-rust">::</span></span>the_table<span class="sy-punctuation sy-terminator sy-rust">;</span>

<span class="sy-meta sy-annotation sy-rust"><span class="sy-punctuation sy-definition sy-annotation sy-rust">#</span><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">[</span><span class="sy-variable sy-annotation sy-rust">derive</span><span class="sy-meta sy-annotation sy-parameters sy-rust"><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span></span><span class="sy-meta sy-annotation sy-parameters sy-rust"><span class="sy-meta sy-group sy-rust">Debug<span class="sy-punctuation sy-separator sy-rust">,</span> Queryable<span class="sy-punctuation sy-separator sy-rust">,</span> Selectable</span></span><span class="sy-meta sy-annotation sy-parameters sy-rust"><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span></span><span class="sy-punctuation sy-section sy-group sy-end sy-rust">]</span></span>
<span class="sy-meta sy-annotation sy-rust"><span class="sy-punctuation sy-definition sy-annotation sy-rust">#</span><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">[</span><span class="sy-variable sy-annotation sy-rust">diesel</span><span class="sy-meta sy-annotation sy-parameters sy-rust"><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span></span><span class="sy-meta sy-annotation sy-parameters sy-rust"><span class="sy-meta sy-group sy-rust">table_name <span class="sy-keyword sy-operator sy-rust">=</span> the_table</span></span><span class="sy-meta sy-annotation sy-parameters sy-rust"><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span></span><span class="sy-punctuation sy-section sy-group sy-end sy-rust">]</span></span>
<span class="sy-meta sy-struct sy-rust"><span class="sy-storage sy-modifier sy-rust">pub</span> <span class="sy-storage sy-type sy-struct sy-rust">struct</span> </span><span class="sy-meta sy-struct sy-rust"><span class="sy-entity sy-name sy-struct sy-rust">PublicData</span> </span><span class="sy-meta sy-struct sy-rust"><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
	<span class="sy-storage sy-modifier sy-rust">pub</span> <span class="sy-variable sy-other sy-member sy-rust">id</span><span class="sy-punctuation sy-separator sy-rust">:</span> <span class="sy-storage sy-type sy-rust">i32</span>,
    <span class="sy-storage sy-modifier sy-rust">pub</span> <span class="sy-variable sy-other sy-member sy-rust">name</span><span class="sy-punctuation sy-separator sy-rust">:</span> String,
    <span class="sy-storage sy-modifier sy-rust">pub</span> <span class="sy-variable sy-other sy-member sy-rust">owner</span><span class="sy-punctuation sy-separator sy-rust">:</span> String,
</span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span></span>

<span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-rust"><span class="sy-storage sy-modifier sy-rust">pub</span> <span class="sy-storage sy-type sy-function sy-rust">fn</span> </span><span class="sy-entity sy-name sy-function sy-rust">get_public_data</span></span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-begin sy-rust">(</span><span class="sy-variable sy-parameter sy-rust">id</span><span class="sy-punctuation sy-separator sy-rust">:</span> <span class="sy-storage sy-type sy-rust">i32</span></span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-end sy-rust">)</span></span></span></span><span class="sy-meta sy-function sy-rust"> <span class="sy-meta sy-function sy-return-type sy-rust"><span class="sy-punctuation sy-separator sy-rust">-&gt;</span> <span class="sy-meta sy-generic sy-rust">Result<span class="sy-punctuation sy-definition sy-generic sy-begin sy-rust">&lt;</span>PartialResult, <span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">result<span class="sy-punctuation sy-accessor sy-rust">::</span></span>error<span class="sy-punctuation sy-definition sy-generic sy-end sy-rust">&gt;</span></span></span> </span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
    <span class="sy-meta sy-path sy-rust">the_table<span class="sy-punctuation sy-accessor sy-rust">::</span></span>table
      .<span class="sy-support sy-function sy-rust">find</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span>id</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
      .<span class="sy-support sy-function sy-rust">select</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span><span class="sy-meta sy-path sy-rust">PartialResult<span class="sy-punctuation sy-accessor sy-rust">::</span></span>as_select<span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
      .<span class="sy-meta sy-path sy-rust">first<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-generic sy-rust"><span class="sy-punctuation sy-definition sy-generic sy-begin sy-rust">&lt;</span>PartialResult<span class="sy-punctuation sy-definition sy-generic sy-end sy-rust">&gt;</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
</span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span></span>
</span></code></pre></li>
      </ul>    </li>
    <li>JSON Deserializing
      <ul class="list-bullet">
        <li>One of diesel&#39;s design decisions is that it will never include any translation code that could fail to serialize or deserialize data from the database. As such, they do not natively support translating from JSON types into Rust structs using the <code>Deserialize</code> attribute. However, this can be implemented generically with a macro, such as this one which converts between the Rust struct and a PostgreSQL JSONB column.</li>
        <li><pre><code><span class="sy-source sy-rust"><span class="sy-meta sy-annotation sy-rust"><span class="sy-punctuation sy-definition sy-annotation sy-rust">#</span><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">[</span><span class="sy-variable sy-annotation sy-rust">macro_export</span><span class="sy-punctuation sy-section sy-group sy-end sy-rust">]</span></span>
<span class="sy-meta sy-macro sy-rust"><span class="sy-support sy-function sy-rust">macro_rules!</span> <span class="sy-entity sy-name sy-macro sy-rust">diesel_jsonb</span> <span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
    <span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span>$type: ty<span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span> <span class="sy-keyword sy-operator sy-rust">=&gt;</span> <span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
        <span class="sy-meta sy-impl sy-rust"><span class="sy-storage sy-type sy-impl sy-rust">impl</span> </span><span class="sy-meta sy-impl sy-rust"><span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">deserialize<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-generic sy-rust">FromSql<span class="sy-punctuation sy-definition sy-generic sy-begin sy-rust">&lt;</span><span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">sql_types<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Jsonb, <span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">pg<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Pg<span class="sy-punctuation sy-definition sy-generic sy-end sy-rust">&gt;</span></span> <span class="sy-keyword sy-other sy-rust">for</span></span><span class="sy-meta sy-impl sy-rust"> <span class="sy-variable sy-other sy-rust">$type</span> </span><span class="sy-meta sy-impl sy-rust"><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
            <span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-rust"><span class="sy-storage sy-type sy-function sy-rust">fn</span> </span><span class="sy-entity sy-name sy-function sy-rust">from_sql</span></span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-begin sy-rust">(</span>
                <span class="sy-variable sy-parameter sy-rust">value</span><span class="sy-punctuation sy-separator sy-rust">:</span> <span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">backend<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-generic sy-rust">RawValue<span class="sy-punctuation sy-definition sy-generic sy-begin sy-rust">&lt;</span>&#39;<span class="sy-keyword sy-operator sy-rust">_</span>, <span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">pg<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Pg<span class="sy-punctuation sy-definition sy-generic sy-end sy-rust">&gt;</span></span>,
            </span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-end sy-rust">)</span></span></span></span><span class="sy-meta sy-function sy-rust"> <span class="sy-meta sy-function sy-return-type sy-rust"><span class="sy-punctuation sy-separator sy-rust">-&gt;</span> <span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">deserialize<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-generic sy-rust">Result<span class="sy-punctuation sy-definition sy-generic sy-begin sy-rust">&lt;</span><span class="sy-storage sy-type sy-rust">Self</span><span class="sy-punctuation sy-definition sy-generic sy-end sy-rust">&gt;</span></span></span> </span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
                <span class="sy-storage sy-type sy-rust">let</span> bytes <span class="sy-keyword sy-operator sy-rust">=</span> value.<span class="sy-support sy-function sy-rust">as_bytes</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span><span class="sy-punctuation sy-terminator sy-rust">;</span>
                <span class="sy-keyword sy-control sy-rust">if</span> bytes<span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">[</span><span class="sy-constant sy-numeric sy-integer sy-decimal sy-rust">0</span><span class="sy-punctuation sy-section sy-group sy-end sy-rust">]</span></span> <span class="sy-keyword sy-operator sy-rust">!</span><span class="sy-keyword sy-operator sy-rust">=</span> <span class="sy-constant sy-numeric sy-integer sy-decimal sy-rust">1</span> <span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
                    <span class="sy-keyword sy-control sy-rust">return</span> <span class="sy-support sy-type sy-rust">Err</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span><span class="sy-string sy-quoted sy-double sy-rust"><span class="sy-punctuation sy-definition sy-string sy-begin sy-rust">&quot;</span>Unsupported JSONB encoding version<span class="sy-punctuation sy-definition sy-string sy-end sy-rust">&quot;</span></span>.<span class="sy-support sy-function sy-rust">into</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span><span class="sy-punctuation sy-terminator sy-rust">;</span>
                </span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span>

                <span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">serde_json<span class="sy-punctuation sy-accessor sy-rust">::</span></span>from_slice<span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span><span class="sy-keyword sy-operator sy-rust">&amp;</span>bytes<span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">[</span><span class="sy-constant sy-numeric sy-integer sy-decimal sy-rust">1</span><span class="sy-keyword sy-operator sy-rust">..</span><span class="sy-punctuation sy-section sy-group sy-end sy-rust">]</span></span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
                    .<span class="sy-support sy-function sy-rust">map_err</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span><span class="sy-meta sy-function sy-closure sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-begin sy-rust">|</span></span></span><span class="sy-meta sy-function sy-closure sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-variable sy-parameter sy-rust">e</span><span class="sy-punctuation sy-section sy-parameters sy-end sy-rust">|</span></span> </span><span class="sy-meta sy-function sy-closure sy-rust"><span class="sy-support sy-macro sy-rust">format!</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-string sy-quoted sy-double sy-rust"><span class="sy-punctuation sy-definition sy-string sy-begin sy-rust">&quot;</span>Invalid JSON: <span class="sy-constant sy-other sy-placeholder sy-rust">{}</span><span class="sy-punctuation sy-definition sy-string sy-end sy-rust">&quot;</span></span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-separator sy-rust">,</span> e<span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>.<span class="sy-support sy-function sy-rust">into</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span></span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
                
                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> This version uses Diesel&#39;s internal translation to serde_json::Value instead,
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> which is simpler but involves an intermediate step of materializing the value as a
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> serde_json::Value.
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> let value = &lt;serde_json::Value as ::diesel::deserialize::FromSql&lt;
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span>     ::diesel::sql_types::Jsonb,
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span>     ::diesel::pg::Pg,
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> &gt;&gt;::from_sql(value)?;
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> Ok(serde_json::from_value(value)?)
</span>            </span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span></span>
        </span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span></span>

        <span class="sy-meta sy-impl sy-rust"><span class="sy-storage sy-type sy-impl sy-rust">impl</span> </span><span class="sy-meta sy-impl sy-rust"><span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">serialize<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-generic sy-rust">ToSql<span class="sy-punctuation sy-definition sy-generic sy-begin sy-rust">&lt;</span><span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">sql_types<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Jsonb, <span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">pg<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Pg<span class="sy-punctuation sy-definition sy-generic sy-end sy-rust">&gt;</span></span> <span class="sy-keyword sy-other sy-rust">for</span></span><span class="sy-meta sy-impl sy-rust"> <span class="sy-variable sy-other sy-rust">$type</span> </span><span class="sy-meta sy-impl sy-rust"><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
            <span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-rust"><span class="sy-storage sy-type sy-function sy-rust">fn</span> </span><span class="sy-entity sy-name sy-function sy-rust">to_sql</span></span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-begin sy-rust">(</span>
                <span class="sy-keyword sy-operator sy-rust">&amp;</span><span class="sy-variable sy-parameter sy-rust">self</span>,
                <span class="sy-variable sy-parameter sy-rust">out</span><span class="sy-punctuation sy-separator sy-rust">:</span> <span class="sy-keyword sy-operator sy-rust">&amp;</span><span class="sy-storage sy-modifier sy-rust">mut</span> <span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">serialize<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-generic sy-rust">Output<span class="sy-punctuation sy-definition sy-generic sy-begin sy-rust">&lt;</span><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">pg<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Pg<span class="sy-punctuation sy-definition sy-generic sy-end sy-rust">&gt;</span></span>,
            </span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-end sy-rust">)</span></span></span></span><span class="sy-meta sy-function sy-rust"> <span class="sy-meta sy-function sy-return-type sy-rust"><span class="sy-punctuation sy-separator sy-rust">-&gt;</span> <span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">serialize<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Result</span> </span><span class="sy-meta sy-function sy-rust"><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-begin sy-rust">{</span>
                <span class="sy-keyword sy-other sy-rust">use</span> <span class="sy-meta sy-path sy-rust">std<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">io<span class="sy-punctuation sy-accessor sy-rust">::</span></span>Write<span class="sy-punctuation sy-terminator sy-rust">;</span>

                out.<span class="sy-support sy-function sy-rust">write_all</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span><span class="sy-keyword sy-operator sy-rust">&amp;</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">[</span><span class="sy-constant sy-numeric sy-integer sy-decimal sy-rust">1</span><span class="sy-punctuation sy-section sy-group sy-end sy-rust">]</span></span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span><span class="sy-keyword sy-operator sy-rust">?</span><span class="sy-punctuation sy-terminator sy-rust">;</span>
                <span class="sy-meta sy-path sy-rust">serde_json<span class="sy-punctuation sy-accessor sy-rust">::</span></span>to_writer<span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span>out<span class="sy-punctuation sy-separator sy-rust">,</span> <span class="sy-variable sy-language sy-rust">self</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
                    .<span class="sy-support sy-function sy-rust">map</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span><span class="sy-meta sy-function sy-closure sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust"><span class="sy-punctuation sy-section sy-parameters sy-begin sy-rust">|</span></span></span><span class="sy-meta sy-function sy-closure sy-rust"><span class="sy-meta sy-function sy-parameters sy-rust">_<span class="sy-punctuation sy-section sy-parameters sy-end sy-rust">|</span></span> </span><span class="sy-meta sy-function sy-closure sy-rust"><span class="sy-meta sy-path sy-rust">diesel<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">serialize<span class="sy-punctuation sy-accessor sy-rust">::</span></span><span class="sy-meta sy-path sy-rust">IsNull<span class="sy-punctuation sy-accessor sy-rust">::</span></span>No</span></span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
                    .<span class="sy-support sy-function sy-rust">map_err</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-begin sy-rust">(</span><span class="sy-support sy-type sy-rust">Into</span><span class="sy-meta sy-path sy-rust"><span class="sy-punctuation sy-accessor sy-rust">::</span></span>into</span><span class="sy-meta sy-group sy-rust"><span class="sy-punctuation sy-section sy-group sy-end sy-rust">)</span></span>
              
                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> Same as above, using Diesel&#39;s internal serde_json::Value support to do most of the work.
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> let value = serde_json::to_value(self)?;
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> &lt;serde_json::Value as diesel::serialize::ToSql&lt;
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span>     diesel::sql_types::Jsonb,
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span>     diesel::pg::Pg,
</span>                <span class="sy-comment sy-line sy-double-slash sy-rust"><span class="sy-punctuation sy-definition sy-comment sy-rust">//</span> &gt;&gt;::to_sql(&amp;value, &amp;mut out.reborrow())
</span>            </span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span></span>
        </span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span></span>
    <span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span>;
</span><span class="sy-meta sy-block sy-rust"><span class="sy-punctuation sy-section sy-block sy-end sy-rust">}</span></span></span>

</span></code></pre></li>
      </ul>    </li>
  </ul>

