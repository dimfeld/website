---
title: "Preview a CSV In-Browser"
tags: 
date: 2023-11-10
updated: 2023-11-10
---


  <ul class="list-bullet">
    <li>This uses <a href="https://www.papaparse.com/">Papa Parse</a> to parse the first few rows of a CSV to preview it before uploading.</li>
    <li><pre><code><span class="sy-text sy-html sy-svelte"><span class="sy-meta sy-tag sy-script sy-begin sy-html"><span class="sy-punctuation sy-definition sy-tag sy-begin sy-html">&lt;</span><span class="sy-entity sy-name sy-tag sy-script sy-html">script</span></span><span class="sy-meta sy-tag sy-script sy-begin sy-html"> <span class="sy-meta sy-attribute-with-value sy-html"><span class="sy-entity sy-other sy-attribute-name sy-html">lang</span></span></span><span class="sy-meta sy-tag sy-script sy-begin sy-html"><span class="sy-meta sy-attribute-with-value sy-html"><span class="sy-punctuation sy-separator sy-key-value sy-html">=</span></span></span><span class="sy-meta sy-tag sy-script sy-begin sy-html"><span class="sy-meta sy-attribute-with-value sy-html"></span></span><span class="sy-meta sy-tag sy-script sy-begin sy-html"><span class="sy-meta sy-attribute-with-value sy-html"><span class="sy-string sy-quoted sy-double sy-html"><span class="sy-punctuation sy-definition sy-string sy-begin sy-html">&quot;</span>ts<span class="sy-punctuation sy-definition sy-string sy-end sy-html">&quot;</span></span></span><span class="sy-punctuation sy-definition sy-tag sy-end sy-html">&gt;</span></span><span class="sy-source sy-ts sy-embedded sy-html"><span class="sy-source sy-ts">
  <span class="sy-meta sy-import sy-ts"><span class="sy-keyword sy-control sy-import sy-ts">import</span> <span class="sy-variable sy-other sy-readwrite sy-alias sy-ts">Papa</span> <span class="sy-keyword sy-control sy-from sy-ts">from</span> <span class="sy-string sy-quoted sy-single sy-ts"><span class="sy-punctuation sy-definition sy-string sy-begin sy-ts">&#39;</span>papaparse<span class="sy-punctuation sy-definition sy-string sy-end sy-ts">&#39;</span></span></span><span class="sy-punctuation sy-terminator sy-statement sy-ts">;</span>
  
  <span class="sy-meta sy-var sy-expr sy-ts"><span class="sy-storage sy-type sy-ts">let</span> <span class="sy-meta sy-var-single-variable sy-expr sy-ts"><span class="sy-meta sy-definition sy-variable sy-ts"><span class="sy-variable sy-other sy-readwrite sy-ts">columns</span></span><span class="sy-meta sy-type sy-annotation sy-ts"><span class="sy-keyword sy-operator sy-type sy-annotation sy-ts">:</span> <span class="sy-support sy-type sy-primitive sy-ts">string</span><span class="sy-keyword sy-operator sy-type sy-ts">|</span><span class="sy-support sy-type sy-builtin sy-ts">undefined</span></span></span></span><span class="sy-punctuation sy-terminator sy-statement sy-ts">;</span>
  <span class="sy-meta sy-var sy-expr sy-ts"><span class="sy-storage sy-type sy-ts">let</span> <span class="sy-meta sy-var-single-variable sy-expr sy-ts"><span class="sy-meta sy-definition sy-variable sy-ts"><span class="sy-variable sy-other sy-readwrite sy-ts">previewRows</span></span><span class="sy-meta sy-type sy-annotation sy-ts"><span class="sy-keyword sy-operator sy-type sy-annotation sy-ts">:</span> <span class="sy-entity sy-name sy-type sy-ts">Array</span><span class="sy-meta sy-type sy-parameters sy-ts"><span class="sy-punctuation sy-definition sy-typeparameters sy-begin sy-ts">&lt;</span></span><span class="sy-meta sy-type sy-parameters sy-ts"><span class="sy-entity sy-name sy-type sy-ts">Record</span><span class="sy-meta sy-type sy-parameters sy-ts"><span class="sy-punctuation sy-definition sy-typeparameters sy-begin sy-ts">&lt;</span></span><span class="sy-meta sy-type sy-parameters sy-ts"><span class="sy-support sy-type sy-primitive sy-ts">string</span><span class="sy-punctuation sy-separator sy-comma sy-ts">,</span> <span class="sy-support sy-type sy-primitive sy-ts">string</span></span><span class="sy-meta sy-type sy-parameters sy-ts"><span class="sy-punctuation sy-definition sy-typeparameters sy-end sy-ts">&gt;</span></span></span><span class="sy-meta sy-type sy-parameters sy-ts"><span class="sy-punctuation sy-definition sy-typeparameters sy-end sy-ts">&gt;</span></span> </span></span><span class="sy-keyword sy-operator sy-assignment sy-ts">=</span><span class="sy-meta sy-array sy-literal sy-ts"> <span class="sy-meta sy-brace sy-square sy-ts">[</span><span class="sy-meta sy-brace sy-square sy-ts">]</span></span></span><span class="sy-punctuation sy-terminator sy-statement sy-ts">;</span>
  
  <span class="sy-meta sy-function sy-ts"><span class="sy-storage sy-modifier sy-async sy-ts">async</span> <span class="sy-storage sy-type sy-function sy-ts">function</span> <span class="sy-meta sy-definition sy-function sy-ts"><span class="sy-entity sy-name sy-function sy-ts">openFile</span></span><span class="sy-meta sy-parameters sy-ts"><span class="sy-punctuation sy-definition sy-parameters sy-begin sy-ts">(</span><span class="sy-variable sy-parameter sy-ts">file</span><span class="sy-meta sy-type sy-annotation sy-ts"><span class="sy-keyword sy-operator sy-type sy-annotation sy-ts">:</span> <span class="sy-entity sy-name sy-type sy-ts">File</span><span class="sy-keyword sy-operator sy-type sy-ts">|</span><span class="sy-support sy-type sy-builtin sy-ts">undefined</span></span><span class="sy-punctuation sy-definition sy-parameters sy-end sy-ts">)</span></span> <span class="sy-meta sy-block sy-ts"><span class="sy-punctuation sy-definition sy-block sy-ts">{</span>
    <span class="sy-keyword sy-control sy-conditional sy-ts">if</span><span class="sy-meta sy-brace sy-round sy-ts">(</span><span class="sy-keyword sy-operator sy-logical sy-ts">!</span><span class="sy-variable sy-other sy-readwrite sy-ts">file</span><span class="sy-meta sy-brace sy-round sy-ts">)</span> <span class="sy-meta sy-block sy-ts"><span class="sy-punctuation sy-definition sy-block sy-ts">{</span>
      <span class="sy-keyword sy-control sy-flow sy-ts">return</span><span class="sy-punctuation sy-terminator sy-statement sy-ts">;</span>
    <span class="sy-punctuation sy-definition sy-block sy-ts">}</span></span>
    
    <span class="sy-meta sy-function-call sy-ts"><span class="sy-variable sy-other sy-object sy-ts">Papa</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-support sy-function sy-ts">parse</span></span><span class="sy-meta sy-brace sy-round sy-ts">(</span><span class="sy-variable sy-other sy-readwrite sy-ts">file</span><span class="sy-punctuation sy-separator sy-comma sy-ts">,</span> <span class="sy-meta sy-objectliteral sy-ts"><span class="sy-punctuation sy-definition sy-block sy-ts">{</span>
      <span class="sy-meta sy-object sy-member sy-ts"><span class="sy-meta sy-object-literal sy-key sy-ts">header</span></span><span class="sy-meta sy-object sy-member sy-ts"><span class="sy-meta sy-object-literal sy-key sy-ts"><span class="sy-punctuation sy-separator sy-key-value sy-ts">:</span></span> <span class="sy-constant sy-language sy-boolean sy-true sy-ts">true</span></span><span class="sy-punctuation sy-separator sy-comma sy-ts">,</span>
      <span class="sy-meta sy-object sy-member sy-ts"><span class="sy-meta sy-object-literal sy-key sy-ts">preview</span></span><span class="sy-meta sy-object sy-member sy-ts"><span class="sy-meta sy-object-literal sy-key sy-ts"><span class="sy-punctuation sy-separator sy-key-value sy-ts">:</span></span> <span class="sy-constant sy-numeric sy-decimal sy-ts">3</span></span><span class="sy-punctuation sy-separator sy-comma sy-ts">,</span> <span class="sy-comment sy-line sy-double-slash sy-ts"><span class="sy-punctuation sy-definition sy-comment sy-ts">//</span></span><span class="sy-comment sy-line sy-double-slash sy-ts"> To read first 3 data rows</span>
      <span class="sy-meta sy-object sy-member sy-ts"><span class="sy-meta sy-object-literal sy-key sy-ts">skipEmptyLines</span></span><span class="sy-meta sy-object sy-member sy-ts"><span class="sy-meta sy-object-literal sy-key sy-ts"><span class="sy-punctuation sy-separator sy-key-value sy-ts">:</span></span> <span class="sy-string sy-quoted sy-single sy-ts"><span class="sy-punctuation sy-definition sy-string sy-begin sy-ts">&#39;</span>greedy<span class="sy-punctuation sy-definition sy-string sy-end sy-ts">&#39;</span></span></span><span class="sy-punctuation sy-separator sy-comma sy-ts">,</span> <span class="sy-comment sy-line sy-double-slash sy-ts"><span class="sy-punctuation sy-definition sy-comment sy-ts">//</span></span><span class="sy-comment sy-line sy-double-slash sy-ts"> Well-formed CSV files don&#39;t need this</span>
<span class="sy-meta sy-method sy-declaration sy-ts">      <span class="sy-meta sy-definition sy-method sy-ts"><span class="sy-entity sy-name sy-function sy-ts">complete</span></span><span class="sy-meta sy-parameters sy-ts"><span class="sy-punctuation sy-definition sy-parameters sy-begin sy-ts">(</span><span class="sy-variable sy-parameter sy-ts">parsed</span><span class="sy-punctuation sy-definition sy-parameters sy-end sy-ts">)</span></span> <span class="sy-meta sy-block sy-ts"><span class="sy-punctuation sy-definition sy-block sy-ts">{</span>
        <span class="sy-keyword sy-control sy-conditional sy-ts">if</span><span class="sy-meta sy-brace sy-round sy-ts">(</span><span class="sy-variable sy-other sy-object sy-ts">parsed</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-variable sy-other sy-property sy-ts">errors</span><span class="sy-punctuation sy-accessor sy-optional sy-ts">?.</span><span class="sy-meta sy-array sy-literal sy-ts"><span class="sy-meta sy-brace sy-square sy-ts">[</span><span class="sy-constant sy-numeric sy-decimal sy-ts">0</span><span class="sy-meta sy-brace sy-square sy-ts">]</span></span><span class="sy-meta sy-brace sy-round sy-ts">)</span> <span class="sy-meta sy-block sy-ts"><span class="sy-punctuation sy-definition sy-block sy-ts">{</span>
          <span class="sy-variable sy-other sy-readwrite sy-ts">error</span> <span class="sy-keyword sy-operator sy-assignment sy-ts">=</span> <span class="sy-variable sy-other sy-object sy-ts">parsed</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-variable sy-other sy-property sy-ts">errors</span><span class="sy-meta sy-array sy-literal sy-ts"><span class="sy-meta sy-brace sy-square sy-ts">[</span><span class="sy-constant sy-numeric sy-decimal sy-ts">0</span><span class="sy-meta sy-brace sy-square sy-ts">]</span></span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-variable sy-other sy-property sy-ts">message</span><span class="sy-punctuation sy-terminator sy-statement sy-ts">;</span>
        <span class="sy-punctuation sy-definition sy-block sy-ts">}</span></span> <span class="sy-keyword sy-control sy-conditional sy-ts">else</span> <span class="sy-keyword sy-control sy-conditional sy-ts">if</span><span class="sy-meta sy-brace sy-round sy-ts">(</span><span class="sy-variable sy-other sy-object sy-ts">parsed</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-variable sy-other sy-object sy-property sy-ts">meta</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-variable sy-other sy-property sy-ts">fields</span><span class="sy-meta sy-brace sy-round sy-ts">)</span> <span class="sy-meta sy-block sy-ts"><span class="sy-punctuation sy-definition sy-block sy-ts">{</span>
          <span class="sy-variable sy-other sy-readwrite sy-ts">columns</span> <span class="sy-keyword sy-operator sy-assignment sy-ts">=</span> <span class="sy-variable sy-other sy-object sy-ts">parsed</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-variable sy-other sy-object sy-property sy-ts">meta</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-variable sy-other sy-property sy-ts">fields</span><span class="sy-punctuation sy-terminator sy-statement sy-ts">;</span>
          <span class="sy-variable sy-other sy-readwrite sy-ts">previewRows</span> <span class="sy-keyword sy-operator sy-assignment sy-ts">=</span> <span class="sy-variable sy-other sy-object sy-ts">parsed</span><span class="sy-punctuation sy-accessor sy-ts">.</span><span class="sy-support sy-variable sy-property sy-dom sy-ts">data</span><span class="sy-punctuation sy-terminator sy-statement sy-ts">;</span>
        <span class="sy-punctuation sy-definition sy-block sy-ts">}</span></span>
      <span class="sy-punctuation sy-definition sy-block sy-ts">}</span></span></span>
    <span class="sy-punctuation sy-definition sy-block sy-ts">}</span></span><span class="sy-meta sy-brace sy-round sy-ts">)</span>
  <span class="sy-punctuation sy-definition sy-block sy-ts">}</span></span></span>
</span></span><span class="sy-meta sy-tag sy-script sy-end sy-html"><span class="sy-punctuation sy-definition sy-tag sy-begin sy-html">&lt;/</span><span class="sy-entity sy-name sy-tag sy-script sy-html">script</span><span class="sy-punctuation sy-definition sy-tag sy-end sy-html">&gt;</span></span>

<span class="sy-meta sy-tag sy-inline sy-form sy-html"><span class="sy-punctuation sy-definition sy-tag sy-begin sy-html">&lt;</span><span class="sy-entity sy-name sy-tag sy-inline sy-form sy-html">input</span> 
  <span class="sy-meta sy-attribute-with-value sy-html"><span class="sy-entity sy-other sy-attribute-name sy-html">type</span><span class="sy-punctuation sy-separator sy-key-value sy-html">=</span><span class="sy-string sy-quoted sy-double sy-html"><span class="sy-punctuation sy-definition sy-string sy-begin sy-html">&quot;</span>file<span class="sy-punctuation sy-definition sy-string sy-end sy-html">&quot;</span></span></span>
  <span class="sy-meta sy-attribute-with-value sy-html"><span class="sy-entity sy-other sy-attribute-name sy-html">name</span><span class="sy-punctuation sy-separator sy-key-value sy-html">=</span><span class="sy-string sy-quoted sy-double sy-html"><span class="sy-punctuation sy-definition sy-string sy-begin sy-html">&quot;</span>csvfile<span class="sy-punctuation sy-definition sy-string sy-end sy-html">&quot;</span></span></span>
  <span class="sy-meta sy-attribute-with-value sy-html"><span class="sy-entity sy-other sy-attribute-name sy-html">accept</span><span class="sy-punctuation sy-separator sy-key-value sy-html">=</span><span class="sy-string sy-quoted sy-double sy-html"><span class="sy-punctuation sy-definition sy-string sy-begin sy-html">&quot;</span>.csv,text/csv<span class="sy-punctuation sy-definition sy-string sy-end sy-html">&quot;</span></span></span>
  <span class="sy-entity sy-other sy-attribute-name sy-svelte"><span class="sy-support sy-function sy-svelte">on</span><span class="sy-punctuation sy-separator sy-svelte">:</span><span class="sy-string sy-unquoted sy-svelte">change</span></span><span class="sy-punctuation sy-separator sy-key-value sy-html">=</span><span class="sy-meta sy-embedded sy-block sy-svelte"><span class="sy-punctuation sy-section sy-embedded sy-begin sy-svelte">{</span></span><span class="sy-meta sy-embedded sy-block sy-svelte"><span class="sy-source sy-js sy-svelte"><span class="sy-meta sy-function sy-js"></span><span class="sy-meta sy-function sy-declaration sy-js"><span class="sy-punctuation sy-section sy-group sy-begin sy-js">(</span><span class="sy-meta sy-binding sy-name sy-js"><span class="sy-variable sy-parameter sy-function sy-js">e</span></span><span class="sy-punctuation sy-section sy-group sy-end sy-js">)</span> <span class="sy-storage sy-type sy-function sy-arrow sy-js">=&gt;</span></span><span class="sy-meta sy-function sy-js"> <span class="sy-meta sy-block sy-js"><span class="sy-meta sy-function-call sy-js"><span class="sy-variable sy-function sy-js">openFile</span><span class="sy-meta sy-group sy-js"><span class="sy-punctuation sy-section sy-group sy-begin sy-js">(</span><span class="sy-variable sy-other sy-readwrite sy-js">e</span><span class="sy-punctuation sy-accessor sy-js">.</span><span class="sy-meta sy-property sy-object sy-js">currentTarget</span><span class="sy-punctuation sy-accessor sy-js">.</span><span class="sy-meta sy-property sy-object sy-js">files</span><span class="sy-keyword sy-operator sy-ternary sy-js">?</span><span class="sy-punctuation sy-accessor sy-js">.</span><span class="sy-meta sy-brackets sy-js"><span class="sy-punctuation sy-section sy-brackets sy-begin sy-js">[</span><span class="sy-constant sy-numeric sy-integer sy-decimal sy-js">0</span><span class="sy-punctuation sy-section sy-brackets sy-end sy-js">]</span></span><span class="sy-punctuation sy-section sy-group sy-end sy-js">)</span></span></span></span></span></span><span class="sy-punctuation sy-section sy-embedded sy-end sy-svelte">}</span></span> 
<span class="sy-punctuation sy-definition sy-tag sy-end sy-html">/&gt;</span></span>
</span></code></pre></li>
  </ul>

