---
title: "2022-09-24"
tags: 
date: 2022-09-24
updated: 2022-09-24
---


  <ul class="list-document">
    
    <li>Finished this iteration of the blog update. With the new SvelteKit version I had to update my janky method of getting the social card generator WASM and fonts into the Vercel deploy. Wasn&#39;t too bad overall though. The main trick is to read files from the working directory when in Vercel, and otherwise read from whereever the files are on your local computer.</li>
    <li><pre><code><span class="hljs-source hljs-js"><span class="hljs-storage hljs-type hljs-js">const</span> <span class="hljs-variable hljs-other hljs-readwrite hljs-js">dirname</span> <span class="hljs-keyword hljs-operator hljs-assignment hljs-js">=</span> <span class="hljs-support hljs-type hljs-object hljs-process hljs-js">process</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-support hljs-type hljs-object hljs-process hljs-js">env</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-meta hljs-property hljs-object hljs-js">VERCEL</span>
  <span class="hljs-keyword hljs-operator hljs-ternary hljs-js">?</span> <span class="hljs-meta hljs-function-call hljs-method hljs-js"><span class="hljs-support hljs-type hljs-object hljs-process hljs-js">process</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-support hljs-function hljs-process hljs-js">cwd</span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">(</span></span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">)</span></span></span>
  <span class="hljs-keyword hljs-operator hljs-ternary hljs-js">:</span> <span class="hljs-variable hljs-other hljs-object hljs-js">path</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-meta hljs-function-call hljs-method hljs-js"><span class="hljs-variable hljs-function hljs-js">dirname</span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">(</span><span class="hljs-meta hljs-function-call hljs-js"><span class="hljs-variable hljs-function hljs-js">fileURLToPath</span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">(</span><span class="hljs-variable hljs-other hljs-object hljs-js">import</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-meta hljs-property hljs-object hljs-js">meta</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-meta hljs-property hljs-object hljs-js">url</span></span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">)</span></span></span></span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">)</span></span></span><span class="hljs-punctuation hljs-terminator hljs-statement hljs-js">;</span>

<span class="hljs-variable hljs-other hljs-object hljs-js">fs</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-meta hljs-function-call hljs-method hljs-js"><span class="hljs-variable hljs-function hljs-js">readFileSync</span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">(</span><span class="hljs-variable hljs-other hljs-object hljs-js">path</span><span class="hljs-punctuation hljs-accessor hljs-js">.</span><span class="hljs-meta hljs-function-call hljs-method hljs-js"><span class="hljs-variable hljs-function hljs-js">join</span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">(</span><span class="hljs-variable hljs-other hljs-readwrite hljs-js">dirname</span><span class="hljs-punctuation hljs-separator hljs-comma hljs-js">,</span> <span class="hljs-string hljs-quoted hljs-single hljs-js"><span class="hljs-punctuation hljs-definition hljs-string hljs-begin hljs-js">&#39;</span>font.ttf<span class="hljs-punctuation hljs-definition hljs-string hljs-end hljs-js">&#39;</span></span></span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">)</span></span></span></span><span class="hljs-meta hljs-group hljs-js"><span class="hljs-punctuation hljs-section hljs-group hljs-js">)</span></span></span><span class="hljs-punctuation hljs-terminator hljs-statement hljs-js">;</span>
</span></code></pre></li>
    <li>Then finally, update your build command to not only run vite build, but also copy the files into the Vercel output:</li>
    <li><pre><code><span class="hljs-text hljs-plain">vite build &amp;&amp; cp ./src/lib/og-image/*.ttf ./vercel/output/functions/render.func
</span></code></pre></li>
    <li>Not pretty and rather fragile, but it works for now.</li>
    <li>Now that I have this &quot;journal&quot; functionality, next up will be some automatic tagging and an index sidebar for the journals. But at least it&#39;s finished enough now that I have a low-friction writing process for short stuff, since I haven&#39;t done any real writing in almost a year.</li>

  </ul>


